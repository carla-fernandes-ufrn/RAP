{% extends "Base/base.html" %} 
{% load static %} 
{% load pagination_tags %}
{% load bootstrap5 %} 
{% load crispy_forms_tags %} 
{% block breadcrumb1 %} Curso {% endblock %} 
{% block breadcrumb2 %} Criação {% endblock %} 
{% block titulo %} Novo curso {% endblock %}
{% block conteudo %}
<br>
<div class="row">
    <div class="col-sm-12 col-md-5 col-lg-3">
        <div id="passo3" class="card border-primary text-center" style="display: none">

            <div class="card-header pb-0 p-3">
                <div class="icon bg-gradient-faded-primary shadow-primary rounded-circle"></div>
                <div class="icon bg-gradient-faded-primary shadow-primary rounded-circle"></div>
                <div class="icon bg-gradient-primary shadow-primary rounded-circle"></div>
                <p class="text-sm mb-0 text-uppercase font-weight-bold">Kit de robótica e linguagem de programação</p>
            </div>
            <div class="card-body p-3 overflow-auto">
                <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Kit de robótica</label>
                    <input class="form-control" type="text" value="">
                    <input class="form-check-input" type="checkbox" value="" id="cb1" style="outline: 1px solid #5e72e4">
                    <label class="form-check-label" for="cb1">
                        <span class="text-xs">Admitir aulas com outros kits de robótica</span>
                    </label>
                    <br>
                    <label for="example-text-input" class="form-control-label">Linguagem de programação</label>
                    <input class="form-control" type="text" value="">
                    <input class="form-check-input" type="checkbox" value="" id="cb1" style="outline: 1px solid #5e72e4">
                    <label class="form-check-label" for="cb1">
                        <span class="text-xs">Admitir aulas com outras linguagens</span>
                    </label>
                    <br>
                    <br>
                    <button class="btn btn-gray btn-sm ms-auto">Voltar</button>
                    <button class="btn btn-primary btn-sm ms-auto">Continuar</button>
                </div>
            </div>
        </div>
        <div id="passo2" class="card border-primary" style="display: none">

            <div class="card-header pb-0 p-3 text-center">
                <div class="icon bg-gradient-faded-primary shadow-primary rounded-circle"></div>
                <div class="icon bg-gradient-primary shadow-primary rounded-circle"></div>
                <div class="icon bg-gradient-faded-primary shadow-primary rounded-circle"></div>
                <p class="text-sm mb-0 text-uppercase font-weight-bold">Disciplinas e conteúdos</p>
            </div>
            <div class="card-body p-3 overflow-auto">
                <div class="form-group">
                    <ul id="myUL">
                        <li><span class="caret">Beverages</span>
                          <ul class="nested">
                            <li>Water</li>
                            <li>Coffee</li>
                            <li><span class="caret">Tea</span>
                              <ul class="nested">
                                <li>Black Tea</li>
                                <li>White Tea</li>
                                <li><span class="caret">Green Tea</span>
                                  <ul class="nested">
                                    <li>Sencha</li>
                                    <li>Gyokuro</li>
                                    <li>Matcha</li>
                                    <li>Pi Lo Chun</li>
                                  </ul>
                                </li>
                              </ul>
                            </li>  
                          </ul>
                        </li>
                    </ul>
                    {% for disciplina in disciplinas %}
                        <i class="fas fa-caret-right"></i>
                        <label> </label>
                        <input class="form-check-input" onclick="click_checkbox('disciplina',{{disciplina.id}})" type="checkbox" value="" id="disciplina_{{disciplina.id}}" style="outline: 1px solid #5e72e4">
                        <label class="form-check-label" for="disciplina_{{disciplina.id}}">
                            {{ disciplina.nome }}
                            {% for conteudo in disciplina.conteudos.all%}
                                {{conteudo.nome}}
                            {% endfor %}
                        </label>
                        <br>
                    {% endfor %}
                    <i class="fas fa-caret-right"></i>
                    <label> </label>
                    <input class="form-check-input" type="checkbox" value="" id="cb1" style="outline: 1px solid #5e72e4">
                    <label class="form-check-label" for="cb1">
                        Artes
                    </label>
                    <br>
                    <i class="fas fa-caret-right"></i>
                    <label> </label>
                    <input class="form-check-input" type="checkbox" value="" id="cb2" style="outline: 1px solid #5e72e4">
                    <label class="form-check-label" for="cb2">
                        Português
                    </label>
                    <br>
                    <i class="fas fa-caret-down"></i>
                    <label> </label>
                    <input class="form-check-input" type="checkbox" value="" id="cb3" style="outline: 1px solid #5e72e4">
                    <label class="form-check-label" for="cb3">
                        Matemática
                    </label>
                    <br>
                    <label class="text-white">espaço</label>
                    <input class="form-check-input" type="checkbox" value="" id="cb1" style="outline: 1px solid #5e72e4">
                    <label class="form-check-label" for="cb1">
                        Frações
                    </label>
                    <br>
                    <label class="text-white">espaço</label>
                    <input class="form-check-input" type="checkbox" value="" id="cb1" style="outline: 1px solid #5e72e4">
                    <label class="form-check-label" for="cb1">
                        Números inteiros
                    </label>
                    <br>
                    <label class="text-white">espaço</label>
                    <input class="form-check-input" type="checkbox" value="" id="cb1" style="outline: 1px solid #5e72e4">
                    <label class="form-check-label" for="cb1">
                        Números reais
                    </label>
                    <br>
                    <br>
                    <div class=" text-center">
                        <button onclick="voltar_passo2()" class="btn btn-gray btn-sm ms-auto">Voltar</button>
                        <button onclick="passo2()" class="btn btn-primary btn-sm ms-auto">Continuar</button>
                    </div>
                    
                </div>
            </div>
        </div>
        <div id="passo1" class="card border-primary text-center">

            <div class="card-header pb-0 p-3">
                <div class="icon bg-gradient-primary shadow-primary rounded-circle"></div>
                <div class="icon bg-gradient-faded-primary shadow-primary rounded-circle"></div>
                <div class="icon bg-gradient-faded-primary shadow-primary rounded-circle"></div>
                <p class="text-sm mb-0 text-uppercase font-weight-bold">Parâmetros iniciais</p>
            </div>
            <div class="card-body p-3 overflow-auto">
                <p><span class="mb-2 text-xs">Indique a quantidade total de aulas do curso. Se desejar, indique a quantidade de aulas em cada categoria. Caso não faça essa indicação, o sistema fará a separação automaticamente.</span></p>
                <p id="passo1_mensagem_erro" style="display: none"><span id="passo1_mensagem_erro_texto" class="mb-2 text-xs" style="color: rgb(245, 54, 92);"></span></p>
                <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Quantidade total de aulas *</label>
                    <input id="qnt_total_aulas" class="form-control" type="number" min="0" value="">
                    <br>
                    <label for="example-text-input" class="form-control-label">Categorias</label>
                    <br>
                    <div class="row">
                        <div class="col-6">
                            <label>Montagem</label>
                            <br>
                            <br>
                            <label>Programação</label>
                            <br>
                            <br>
                            <label>Aplicação</label>
                        </div>
                        <div class="col-6">
                            <input id="qnt_aulas_montagem" class="form-control" type="number" min="0" value="">
                            <br>
                            <input id="qnt_aulas_programacao" class="form-control" type="number" min="0" value="">
                            <br>
                            <input id="qnt_aulas_aplicacao" class="form-control" type="number" min="0" value="">
                        </div>
                    </div>
                    <br>
                    <button disabled=true class="btn btn-gray btn-sm ms-auto">Voltar</button>
                    <button onclick="passo1()" class="btn btn-primary btn-sm ms-auto">Continuar</button>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-12 col-md-7 col-lg-9">
            <div class="card">
                <div class="card-body p-3 overflow-auto">
                    <!-- <p>Não foram encontradas aulas que formem o curso com os parâmetros indicados.</p> -->
                    <div class="row">
                        <div class="col-4">
                            <label for="example-text-input" class="form-control-label">Quantidade total de aulas</label>
                            <p id="texto_qnt_total_aulas"></p>
                            <br>
                            <span class="mb-2 text-xs">Montagem: <span id="texto_qnt_aulas_montagem" class="text-dark font-weight-bold ms-sm-2"></span></span>
                            <br>
                            <span class="mb-2 text-xs">Programação: <span id="texto_qnt_aulas_programacao" class="text-dark font-weight-bold ms-sm-2"></span></span>
                            <br>
                            <span class="mb-2 text-xs">Aplicação: <span id="texto_qnt_aulas_aplicacao" class="text-dark font-weight-bold ms-sm-2"></span></span>
                        </div>
                        <div class="col-4">
                            <label for="example-text-input" class="form-control-label">Disciplinas e conteúdos selecionados</label>
                            <span class="mb-2 text-xs">Matemática: <span class="text-dark font-weight-bold ms-sm-2">Equações de primeiro grau</span></span>
                            <br>
                            <span class="mb-2 text-xs">Matemática: <span class="text-dark font-weight-bold ms-sm-2">Números inteiros</span></span>
                            <br>
                            <span class="mb-2 text-xs">Matemática: <span class="text-dark font-weight-bold ms-sm-2">Números reais</span></span>
                            <br>
                            <span class="mb-2 text-xs">Inglês<span class="text-dark font-weight-bold ms-sm-2"></span></span>
                        </div>
                        <div class="col-4">
                            <label for="example-text-input" class="form-control-label">Kit de robótica e linguagem de programação</label>
                            <!-- <span class="mb-2 text-xs">Kit de robótica: <span class="text-dark font-weight-bold ms-sm-2">Lego EV3</span></span>
                            <br>
                            <span class="mb-2 text-xs">Linguagem de programação: <span class="text-dark font-weight-bold ms-sm-2">Python</span></span>
                            <br> -->
                            <span class="mb-2 text-xs">Kit de robótica: <span class="text-dark font-weight-bold ms-sm-2">Livre</span></span>
                            <br>
                            <span class="mb-2 text-xs">Linguagem de programação: <span class="text-dark font-weight-bold ms-sm-2">Livre</span></span>
                            <br>
                        </div>
                    </div>
                    <br>
                    <!-- <p>Sugestão de alterações:</p> -->
                    <!-- <h6 class="mb-1 text-dark text-sm">Adicionar novos conteúdos para o curso</h6>
                    <span class="mb-2 text-xs">Matemática: <span class="text-dark font-weight-bold ms-sm-2">Números inteiros</span></span>
                    <br>
                    <span class="mb-2 text-xs">Matemática: <span class="text-dark font-weight-bold ms-sm-2">Números reais</span></span>
                    <br>
                    <span class="mb-2 text-xs">Matemática: <span class="text-dark font-weight-bold ms-sm-2">Formas geométricas</span></span>
                    <br>
                    <span class="mb-2 text-xs">Matemática: <span class="text-dark font-weight-bold ms-sm-2">Equações de segundo grau</span></span>
                    <br> -->
                    <!-- <h6 class="mb-1 text-dark text-sm">Admitir aulas com outros kits de robótica</h6>
                    <h6 class="mb-1 text-dark text-sm">Admitir aulas com outras linguagens de programação</h6> -->

                    <div class="card">
                        <div class="card-header pb-0 p-3">
                            <button class="btn btn-icon-only btn-rounded btn-outline-primary mb-0 me-3 btn-sm d-flex align-items-center justify-content-center">1</button>
                            <a href="">Números inteiros com robótica livre</a>
                            <br>
                            <span class="mb-2 text-xs">Categoria: <span class="text-dark font-weight-bold ms-sm-2">Montagem</span></span>
                        </div>
                        <div class="card-body p-3 overflow-auto">
                            
                        </div>
                        <div class="card-header pb-0 p-3">
                            <button class="btn btn-icon-only btn-rounded btn-outline-primary mb-0 me-3 btn-sm d-flex align-items-center justify-content-center">2</button>
                            <a href="">Ensinando Arduino com matemática</a>
                            <br>
                            <span class="mb-2 text-xs">Categoria: <span class="text-dark font-weight-bold ms-sm-2">Montagem</span></span>
                        </div>
                        <div class="card-body p-3 overflow-auto">
                            
                        </div>
                        <div class="card-header pb-0 p-3">
                            <button class="btn btn-icon-only btn-rounded btn-outline-primary mb-0 me-3 btn-sm d-flex align-items-center justify-content-center">3</button>
                            <a href="">Números reais</a>
                            <br>
                            <span class="mb-2 text-xs">Categoria: <span class="text-dark font-weight-bold ms-sm-2">Montagem</span></span>
                        </div>
                        <div class="card-body p-3 overflow-auto">
                            
                        </div>
                        <div class="card-header pb-0 p-3">
                            <button class="btn btn-icon-only btn-rounded btn-outline-primary mb-0 me-3 btn-sm d-flex align-items-center justify-content-center">4</button>
                            <a href="">Números inteiros: Lego EV3</a>
                            <br>
                            <span class="mb-2 text-xs">Categoria: <span class="text-dark font-weight-bold ms-sm-2">Montagem</span></span>
                        </div>
                        <div class="card-body p-3 overflow-auto">
                            
                        </div>
                        <div class="card-header pb-0 p-3">
                            <button class="btn btn-icon-only btn-rounded btn-outline-primary mb-0 me-3 btn-sm d-flex align-items-center justify-content-center">5</button>
                            <a href="">Números inteiros com robótica livre</a>
                            <br>
                            <span class="mb-2 text-xs">Categoria: <span class="text-dark font-weight-bold ms-sm-2">Montagem</span></span>
                        </div>
                        <div class="card-body p-3 overflow-auto">
                            
                        </div>
                        <div class="card-header pb-0 p-3">
                            <button class="btn btn-icon-only btn-rounded btn-outline-success mb-0 me-3 btn-sm d-flex align-items-center justify-content-center">6</button>
                            <a href="">Números inteiros com robótica livre</a>
                            <br>
                            <span class="mb-2 text-xs">Categoria: <span class="text-dark font-weight-bold ms-sm-2">Programação</span></span>
                        </div>
                        <div class="card-body p-3 overflow-auto">
                            
                        </div>
                    </div>
                    <br/>
                </div>
            </div>
        <nav class="justify-content-center d-flex pagination">
            <ul class="pagination">
                {% if page_obj.has_previous %}
                    <li class="page-item">
                        <a href="?{% url_replace request 'page' page_obj.previous_page_number %}" class="page-link" aria-label="Previous">
                            <i class="fas fa-chevron-left"></i>
                        </a>
                    </li>
                {% else %}
                    <li class="page-item disabled">
                        <a href="" class="page-link" aria-label="Previous">
                            <i class="fas fa-chevron-left"></i>
                        </a>
                    </li>
                {% endif %}
      
                {% if page_obj.number|add:'-2' > 1 %}
                    <li class="page-item">
                        <a href="?{% url_replace request 'page' page_obj.number|add:'-3' %}" class="page-link">&hellip;</a>
                    </li>
                {% endif %}
      
                {% for i in page_obj.paginator.page_range %}
                    {% if page_obj.number == i %}
                        <li class="active page-item">
                            <span class="page-link">{{ i }} <span class="sr-only">(current)</span></span>
                        </li>
                    {% elif i > page_obj.number|add:'-3' and i < page_obj.number|add:'3' %}
                        <li class="page-item">
                            <a href="?{% url_replace request 'page' i %}" class="page-link">{{ i }}</a>
                        </li>
                    {% endif %}
                {% endfor %}
      
                {% if page_obj.paginator.num_pages > page_obj.number|add:'2' %}
                    <li class="page-item">
                        <a href="?{% url_replace request 'page' page_obj.number|add:'3' %}" class="page-link">&hellip;</a>
                    </li>
                {% endif %}
      
                {% if page_obj.has_next %}
                    <li class="page-item">
                        <a href="?{% url_replace request 'page' page_obj.next_page_number %}" class="page-link" aria-label="Next">
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </li>
                {% else %}
                    <li class="page-item disabled">
                        <a href="" class="page-link" aria-label="Next">
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </li>
                {% endif %}
            </ul>
        </nav>
    </div>

</div>


{% endblock %} {% block scripts %}

<script>
    var conteudos_selecionados = []

    function passo1() {
        var qnt_total_aulas = Number(document.getElementById("qnt_total_aulas").value)
        var qnt_aulas_montagem = Number(document.getElementById("qnt_aulas_montagem").value)
        var qnt_aulas_programacao = Number(document.getElementById("qnt_aulas_programacao").value)
        var qnt_aulas_aplicacao = Number(document.getElementById("qnt_aulas_aplicacao").value)
        
        if (qnt_total_aulas <= 0) {
            document.getElementById("passo1_mensagem_erro").style.display = 'block';
            document.getElementById("passo1_mensagem_erro_texto").innerHTML = "Indique a quantidade total de aulas."
        }
        else if ((qnt_total_aulas < (qnt_aulas_montagem + qnt_aulas_programacao + qnt_aulas_aplicacao)) ||
                (qnt_aulas_montagem > 0 && qnt_aulas_programacao > 0 && qnt_aulas_aplicacao > 0 && qnt_total_aulas > (qnt_aulas_montagem + qnt_aulas_programacao + qnt_aulas_aplicacao))) {
            document.getElementById("passo1_mensagem_erro").style.display = 'block';
            document.getElementById("passo1_mensagem_erro_texto").innerHTML = "Confira o número de aulas inserido entre as categorias."
        }
        else {
            document.getElementById("passo2").style.display = 'block';
            document.getElementById("passo1").style.display = 'none';
            document.getElementById("passo3").style.display = 'none';
            document.getElementById("passo1_mensagem_erro").style.display = 'none';

            qnt_aulas = definir_qnt_aulas(qnt_total_aulas, qnt_aulas_montagem, qnt_aulas_programacao, qnt_aulas_aplicacao)
            qnt_aulas_montagem = qnt_aulas[0]
            qnt_aulas_programacao = qnt_aulas[1]
            qnt_aulas_aplicacao = qnt_aulas[2]

            document.getElementById("texto_qnt_total_aulas").innerHTML = aulas_plural_singular(qnt_total_aulas)
            document.getElementById("texto_qnt_aulas_montagem").innerHTML = aulas_plural_singular(qnt_aulas_montagem)
            document.getElementById("texto_qnt_aulas_programacao").innerHTML = aulas_plural_singular(qnt_aulas_programacao)
            document.getElementById("texto_qnt_aulas_aplicacao").innerHTML = aulas_plural_singular(qnt_aulas_aplicacao)
        }
    }

    function definir_qnt_aulas(total, montagem, programacao, aplicacao) {
        if (montagem != "" && programacao != "" && aplicacao != "") {
            return [montagem, programacao, aplicacao]
        }
        else if (montagem != "") {
            if (programacao != "") {
                return [montagem, programacao, (total-montagem-programacao)]
            }
            else if (aplicacao != "") {
                return [montagem, (total-montagem-aplicacao), aplicacao]
            }
            else {
                if ((total-montagem)%2 == 0) {
                    return [montagem, (total-montagem)/2, (total-montagem)/2]
                }
                else {
                    return [montagem, (total-montagem-1)/2, (total-montagem+1)/2]
                }
            }
        }
        else if (programacao != "") {
            if (aplicacao != "") {
                return [total-programacao-aplicacao, programacao, aplicacao]
            }
            else {
                if ((total-programacao)%2 == 0) {
                    return [(total-programacao)/2, programacao, (total-programacao)/2]
                }
                else {
                    return [(total-programacao-1)/2, programacao, (total-programacao+1)/2]
                }
            }
        }
        else if (aplicacao != "") {
            if ((total-aplicacao)%2 == 0) {
                return [(total-aplicacao)/2, (total-aplicacao)/2, aplicacao]
            }
            else {
                return [(total-aplicacao-1)/2, (total-aplicacao+1)/2, aplicacao]
            }
        }
        else {
            return [Math.floor(total/3), Math.floor(total/3), total-2*Math.floor(total/3)]
        }
    }

    function aulas_plural_singular(valor) {
        if (valor == 1) {
            return String(valor) + " aula"
        }
        else {
            return String(valor) + " aulas"
        }
    }

    function voltar_passo2() {
        document.getElementById("passo1").style.display = 'block';
        document.getElementById("passo2").style.display = 'none';
        document.getElementById("passo3").style.display = 'none';
    }

    var disciplinas_selecionadas = []
    var conteudos_selecionados = []

    function click_checkbox(tipo, id) {
        var checkBox = document.getElementById(tipo + "_" + id);
        if (checkBox.checked == true){
            if (tipo === 'disciplina') {
                adicionar_disciplina(id)
            }
            else {
                adicionar_conteudo(id)
            }
        } else {
            if (tipo === 'disciplina') {
                remover_disciplina(id)
            }
            else {
                remover_conteudo(id)
            }
        }
    }

    function adicionar_conteudo(id_conteudo) {
        conteudos_selecionados.push(id_conteudo)
    }

    function adicionar_disciplina(id_disciplina) {
        disciplinas_selecionadas.push(id_disciplina)
    }

    function remover_conteudo(id_conteudo) {
        conteudos_selecionados.splice(conteudos_selecionados.indexOf(id_conteudo), 1);
    }

    function remover_disciplina(id_disciplina) {
        disciplinas_selecionadas.splice(disciplinas_selecionadas.indexOf(id_disciplina), 1);
    }

    var toggler = document.getElementsByClassName("caret");
    var i;

    for (i = 0; i < toggler.length; i++) {
        toggler[i].addEventListener("click", function() {
            this.parentElement.querySelector(".nested").classList.toggle("active");
            this.classList.toggle("caret-down");
        });
    }
</script>

{% endblock %}